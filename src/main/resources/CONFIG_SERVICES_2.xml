<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
		http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.1.xsd">


    <util:map id="serviceStrategies">
        <entry key="CALL_PROCEDURE_AND_FETCH">
            <list>
                <bean class="mb.dnm.service.db.Select">
                    <property name="output" value="records"/>
                </bean>

                <bean class="mb.dnm.service.general.StopIfInputIsNullOrEmpty">
                    <property name="input"  value="records"/>
                </bean>


                <bean class="mb.dnm.service.db.StartTransaction"/>
                <bean class="mb.dnm.service.db.CallProcedure">
                    <property name="input"  value="records"/>
                </bean>

                <bean class="mb.dnm.service.db.Fetch">
                    <property name="output"     value="fetch_result"/>
                </bean>

                <bean class="mb.dnm.service.db.EndTransaction"/>

                <bean class="mb.dnm.service.general.PrintInput">
                    <property name="input"                          value="fetch_result"/>
                    <property name="printToXmlWhenCollectionOrMap"       value="true"/>
                    <property name="indented"                       value="true"/>
                </bean>
            </list>
        </entry>

        <entry key="FETCHED_SELECT">
            <list>
                <bean class="mb.dnm.service.db.StartTransaction"/>
                <bean class="mb.dnm.service.db.OpenCursor"/>
                <bean class="mb.dnm.service.general.IterationGroup">
                    <property name="iterateUntilBreak"  value="true"/>
                    <property name="services">
                        <list>
                            <bean class="mb.dnm.service.db.Fetch">
                                <property name="output"     value="fetch_result"/>
                            </bean>
                            <bean class="mb.dnm.service.general.PrintInput">
                                <property name="input"                          value="fetch_result"/>
                                <property name="printToXmlWhenCollectionOrMap"       value="true"/>
                                <property name="indented"                       value="true"/>
                            </bean>
                            <bean class="mb.dnm.service.general.BreakIteration">
                                <property name="input"  value="fetch_result"/>
                            </bean>
                        </list>
                    </property>
                </bean>
                <bean class="mb.dnm.service.db.EndTransaction"/>


            </list>
        </entry>

        <entry key="ITER_TEST">
            <list>
                <bean class="mb.dnm.service.db.StartTransaction"/>
                <bean class="mb.dnm.service.general.IterationGroup">
                    <property name="iterateUntilBreak"  value="true"/>
                    <property name="services">
                        <list>
                            <bean class="mb.dnm.service.db.Select">
                                <property name="output"     value="select_result"/>
                            </bean>
                            <bean class="mb.dnm.service.general.BreakIteration">
                                <property name="input"  value="select_result"/>
                            </bean>
                            <bean class="mb.dnm.service.db.Update">
                                <property name="input"  value="select_result"/>
                            </bean>
                        </list>
                    </property>
                </bean>
                <bean class="mb.dnm.service.db.EndTransaction"/>
            </list>
        </entry>

        <entry key="SIZE_TEST">
            <list>
                <bean class="mb.dnm.service.db.Select">
                    <property name="output"     value="select_list"/>
                </bean>
                <bean class="mb.dnm.service.general.GetSize">
                    <property name="input"      value="select_list"/>
                    <property name="output"     value="select_list_size"/>
                </bean>
                <bean class="mb.dnm.service.general.PrintInput">
                    <property name="input"      value="select_list_size"/>
                </bean>
            </list>
        </entry>


        <entry key="HTTP_TEST">
            <list>
                <bean class="mb.dnm.service.general.TransformData">
                    <property name="input"              value="$http_body"/>
                    <property name="inputDataType"      value="JSON"/>
                    <property name="outputDataType"     value="MAP"/>
                    <property name="output"             value="$http_body"/>
                </bean>
                <bean class="mb.dnm.service.general.PrintInput">
                    <property name="input"                          value="$http_body"/>
                    <property name="printToJsonWhenCollectionOrMap" value="true"/>
                    <property name="indented"                       value="true"/>
                </bean>
            </list>
        </entry>

        <entry key="CRYPTO_TEST">
            <list>
                <bean class="mb.dnm.service.general.StopIfInputIsNullOrEmpty">
                    <property name="input"              value="$http_body"/>
                </bean>
                <bean class="mb.dnm.service.general.TransformData">
                    <property name="input"              value="$http_body"/>
                    <property name="inputDataType"      value="JSON"/>
                    <property name="outputDataType"     value="MAP"/>
                    <property name="output"             value="$http_body"/>
                </bean>
                <bean class="mb.dnm.service.general.PrintInput">
                    <property name="input"                          value="$http_body"/>
                    <property name="printToJsonWhenCollectionOrMap" value="true"/>
                    <property name="indented"                       value="true"/>
                </bean>
                <bean class="mb.dnm.service.crypto.Encrypt">
                    <property name="cryptoType"         value="SEED128"/>
                    <property name="input"              value="$http_body"/>
                    <property name="output"             value="enc_data"/>
                </bean>
                <bean class="mb.dnm.service.general.PrintInput">
                    <property name="input"                          value="enc_data"/>
                    <property name="printToJsonWhenCollectionOrMap" value="true"/>
                    <property name="indented"                       value="true"/>
                </bean>
                <bean class="mb.dnm.service.crypto.Decrypt">
                    <property name="cryptoType"         value="SEED128"/>
                    <property name="input"              value="enc_data"/>
                    <property name="output"             value="dec_data"/>
                </bean>
                <bean class="mb.dnm.service.general.PrintInput">
                    <property name="input"                          value="dec_data"/>
                    <property name="printToJsonWhenCollectionOrMap" value="true"/>
                    <property name="indented"                       value="true"/>
                </bean>
            </list>
        </entry>
    </util:map>

</beans>