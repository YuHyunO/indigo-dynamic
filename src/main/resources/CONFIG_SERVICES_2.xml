<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
		http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.1.xsd">


    <util:map id="serviceStrategies">
        <entry key="CALL_PROCEDURE_AND_FETCH">
            <list>
                <bean class="mb.dnm.service.db.Select">
                    <property name="output" value="records"/>
                </bean>

                <bean class="mb.dnm.service.general.StopIfInputIsNullOrEmpty">
                    <property name="input"  value="records"/>
                </bean>


                <bean class="mb.dnm.service.db.StartTransaction"/>
                <bean class="mb.dnm.service.db.CallProcedure">
                    <property name="input"  value="records"/>
                </bean>

                <bean class="mb.dnm.service.db.Fetch">
                    <property name="output"     value="fetch_result"/>
                </bean>

                <bean class="mb.dnm.service.db.EndTransaction"/>

                <bean class="mb.dnm.service.general.PrintInput">
                    <property name="input"                          value="fetch_result"/>
                    <property name="printToXmlWhenCollection"       value="true"/>
                    <property name="indented"                       value="true"/>
                </bean>
            </list>
        </entry>

        <entry key="FETCHED_SELECT">
            <list>
                <bean class="mb.dnm.service.db.StartTransaction"/>
                <bean class="mb.dnm.service.db.OpenCursor"/>
                <bean class="mb.dnm.service.general.IterationGroup">
                    <property name="iterateUntilBreak"  value="true"/>
                    <property name="services">
                        <list>
                            <bean class="mb.dnm.service.db.Fetch">
                                <property name="output"     value="fetch_result"/>
                            </bean>
                            <bean class="mb.dnm.service.general.BreakIteration">
                                <property name="input"  value="fetch_result"/>
                            </bean>
                        </list>
                    </property>
                </bean>
                <bean class="mb.dnm.service.db.EndTransaction"/>


            </list>
        </entry>
    </util:map>

</beans>